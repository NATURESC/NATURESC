<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>æ¢æ¢5å‘¨å¹´å¤§æŠ½å¥–ï¼ˆSupabase ç‰ˆï¼‰</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background: linear-gradient(180deg, #ffcf4b 0%, #ff9a00 100%);
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            padding-bottom: 60px;
        }

        .header { text-align: center; margin-top: 30px; color: #d93600; }
        .header h1 { font-size: 24px; font-weight: bold; border: 2px solid #333; display: inline-block; padding: 5px 20px; margin-bottom: 10px; background: #fffdf0; border-radius: 6px;}
        .header h2 { font-size: 32px; font-weight: 800; text-shadow: 1px 1px 2px rgba(255,255,255,0.5); color:#6b2100; margin-top:8px;}

        .wheel-container {
            position: relative;
            width: 320px; height: 320px;
            margin: 20px auto;
            padding: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border-radius: 50%;
            background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(0,0,0,0.05));
            border: 4px solid #ffeb3b;
        }
        .wheel-container::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            border-radius: 50%; border: 2px dashed rgba(255,255,255,0.25);
            animation: flash 1s infinite; pointer-events: none;
        }
        @keyframes flash { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        .wheel {
            width: 100%; height: 100%;
            background: #fffdf0; border-radius: 50%;
            position: relative; overflow: hidden;
            transition: transform 4s cubic-bezier(0.2, 0.8, 0.3, 1);
        }
        .wheel-bg {
            width: 100%; height: 100%; border-radius: 50%;
            background: conic-gradient(
                #fffdf0 0deg 60deg, #ffe0b2 60deg 120deg,
                #fffdf0 120deg 180deg, #ffe0b2 180deg 240deg,
                #fffdf0 240deg 300deg, #ffe0b2 300deg 360deg
            );
        }
        .prize-item {
            position: absolute; top: 0; left: 50%;
            width: 100px; height: 50%; margin-left: -50px;
            transform-origin: bottom center; text-align: center;
            padding-top: 20px; font-size: 12px; color: #d35400; font-weight: bold;
        }
        .item-1 { transform: rotate(30deg); }
        .item-2 { transform: rotate(90deg); }
        .item-3 { transform: rotate(150deg); }
        .item-4 { transform: rotate(210deg); }
        .item-5 { transform: rotate(270deg); }
        .item-6 { transform: rotate(330deg); }
        .prize-icon { display: block; width: 30px; height: 30px; background: #ddd; margin: 5px auto; border-radius: 4px; line-height: 30px; font-size: 14px; color: #666; }

        .pointer {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 80px; height: 80px;
            background: linear-gradient(to bottom, #ffcc00, #ff9900);
            border-radius: 50%; border: 4px solid #fff;
            box-shadow: 0 4px 0 #cc7a00;
            z-index: 10; display: flex; justify-content: center; align-items: center;
            font-size: 20px; font-weight: bold; color: #d35400; cursor: pointer;
        }
        .pointer::before {
            content: ''; position: absolute; top: -20px; left: 50%;
            transform: translateX(-50%);
            border-width: 15px; border-style: solid;
            border-color: transparent transparent #ffcc00 transparent;
        }
        .pointer:active { transform: translate(-50%, -48%); box-shadow: 0 2px 0 #cc7a00; }
        .pointer.disabled {
            background: #ccc; box-shadow: 0 4px 0 #999; color: #666; cursor: not-allowed;
        }
        .pointer.disabled::before { border-bottom-color: #ccc; }

        .footer-list {
            width: 90%; background: rgba(255, 255, 255, 0.12);
            border-radius: 10px; padding: 10px; margin-top: 10px;
            text-align: center; z-index: 5; height: 150px;
            display: flex; flex-direction: column;
            backdrop-filter: blur(3px);
        }
        .list-title { color: #fff; font-size: 14px; margin-bottom: 8px; font-weight: bold; flex-shrink: 0;}
        .marquee-container { flex: 1; overflow-y: auto; position: relative; -webkit-overflow-scrolling: touch; padding:6px;}
        .marquee-container::-webkit-scrollbar { width: 6px; }
        .marquee-container::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }

        .record-item { color: #fff; font-size: 13px; line-height: 26px; border-bottom: 1px dashed rgba(255,255,255,0.12); padding: 2px 4px; text-align:left;}
        .record-item b { color: #d93600; background: rgba(255,255,255,0.6); padding: 0 6px; border-radius: 4px; margin-right:6px; font-weight:700;}
        .record-time { font-size: 11px; color: #fff; opacity: 0.85; float:right; }

        .city-bg { position: fixed; bottom: 0; width: 100%; height: 60px; background-color: #e67e22; mask-image: linear-gradient(to top, black, transparent); -webkit-mask-image: linear-gradient(to top, black, transparent); opacity: 0.5; z-index: 0; }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 100; display: none;
            justify-content: center; align-items: center;
        }
        .modal-box { background: #fff; width: 88%; max-width: 320px; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3); animation: popIn 0.25s; }
        .modal-title { font-size: 18px; color: #333; margin-bottom: 12px; font-weight: bold; }
        .modal-input { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; margin-bottom: 12px; outline: none; }
        .modal-input:focus { border-color: #ff9900; }
        .modal-btn { background: linear-gradient(to right, #ff9900, #ff5e00); color: white; border: none; padding: 10px 30px; border-radius: 20px; font-size: 16px; cursor: pointer; box-shadow: 0 4px 10px rgba(255, 94, 0, 0.3); }

        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <!-- å§“åè¾“å…¥å¼¹çª— -->
    <div class="modal-overlay" id="nameModal">
        <div class="modal-box">
            <div class="modal-title">è¯·è¾“å…¥æ‚¨çš„å§“å</div>
            <input type="text" class="modal-input" id="usernameInput" placeholder="ä¾‹å¦‚ï¼šæå››" maxlength="20" />
            <div style="display:flex; justify-content:center; gap:10px;">
                <button class="modal-btn" onclick="submitName()">å¼€å§‹æŠ½å¥–</button>
            </div>
        </div>
    </div>

    <div class="header">
        <h1>æ¢æ¢</h1>
        <h2>æ¢æ¢5å‘¨å¹´<br>æ‹‰äººå¤§æŠ½å¥–</h2>
    </div>

    <div class="wheel-container">
        <div class="wheel" id="wheel">
            <div class="wheel-bg"></div>
            <div class="prize-item item-1"><span>çºªæ¢µå¸Œ<br>å°ç¾Šçš®å£çº¢</span><span class="prize-icon">ğŸ’„</span></div>
            <div class="prize-item item-2"><span>ARMANI<br>é˜¿ç›å°¼</span><span class="prize-icon">ğŸ</span></div>
            <div class="prize-item item-3"><span>æ¢æ¢<br>VIPä¼šå‘˜</span><span class="prize-icon">ğŸ‘‘</span></div>
            <div class="prize-item item-4"><span>iPhone<br>XS</span><span class="prize-icon">ğŸ“±</span></div>
            <div class="prize-item item-5"><span>åœ£ç½—å…°<br>å£çº¢</span><span class="prize-icon">ğŸ’„</span></div>
            <div class="prize-item item-6"><span>è°¢è°¢<br>å‚ä¸</span><span class="prize-icon">ğŸ˜Š</span></div>
        </div>

        <div class="pointer" id="drawBtn" onclick="checkUserAndSpin()">æŠ½å¥–</div>
    </div>

    <div class="footer-list">
        <div class="list-title">â€”â€” ä¸­å¥–åå• (å®æ—¶æ›´æ–°) â€”â€”</div>
        <div class="marquee-container" id="marqueeList">
            <!-- åˆ—è¡¨å°†ç”±JSåŠ è½½ -->
        </div>
    </div>

    <div class="city-bg"></div>

    <script>
    /******************************
     *  è¯·åŠ¡å¿…æ›¿æ¢ä¸‹é¢ä¸¤é¡¹ä¸ºä½ è‡ªå·±çš„ Supabase é…ç½®ï¼
     *  Supabase Dashboard -> Project Settings -> API
     ******************************/
    const SUPA_URL = "https://meiydxhkrtsupwzlvdiv.supabase.co"; // e.g. https://xxxxx.supabase.co
    const SUPA_KEY = "sb_publishable_IoTm5rBUQo7_KuF9yM3UiA_xSbfGR2K";    // anon public key

    // åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
    // ç­‰ supabase è„šæœ¬åŠ è½½å®Œå†åˆå§‹åŒ–ï¼ˆå½»åº•è§£å†³æŠ¥é”™ï¼‰
const supabase = window.supabase?.createClient?.(SUPA_URL, SUPA_KEY) 
    || setTimeout(() => location.reload(), 500);  // å¦‚æœè¿˜æ²¡åŠ è½½å®Œå°±åˆ·æ–°ä¸€æ¬¡

    /******************************
     * æ³¨æ„ï¼šåœ¨ Supabase æ§åˆ¶å°çš„ SQL Editor æˆ– Table Editor
     * åˆ›å»ºè¡¨ï¼ˆå¦‚æœè¿˜æ²¡åˆ›å»ºï¼‰ï¼š
     *
     * create table if not exists records (
     *   id bigint generated always as identity primary key,
     *   user_name text,
     *   prize text,
     *   created_at timestamptz default now()
     * );
     *
     * å¹¶ä¸”æ‰“å¼€ Row Level Security åæ·»åŠ ä¸¤æ¡ policyï¼ˆä»…ç¤ºä¾‹ï¼Œä»…åœ¨ä½ ç†è§£é£é™©åä½¿ç”¨ï¼‰ï¼š
     *
     * -- å…è®¸åŒ¿åæ’å…¥
     * create policy "allow_insert" on public.records
     * for insert
     * using ( true );
     *
     * -- å…è®¸åŒ¿åæŸ¥è¯¢
     * create policy "allow_select" on public.records
     * for select
     * using ( true );
     *
     * ä¸Šé¢ policy åªæœ‰åœ¨ä½ æƒ³è®©å‰ç«¯åŒ¿åè¯»å†™æ—¶æ‰å¯ç”¨ï¼ˆé€‚ç”¨äºæŠ½å¥–åå•å±•ç¤ºåœºæ™¯ï¼‰ã€‚
     ******************************/

    // æœ¬åœ°ç¼“å­˜ KEYï¼ˆç”¨äºæ¯æ—¥é™åˆ¶ä¸å¤‡ä»½ï¼‰
    const STORAGE_KEY_RECORDS = 'lottery_records_v1';
    const STORAGE_KEY_LAST_DATE = 'lottery_last_date_v1';

    let isSpinning = false;
    let currentRotation = 0;
    let currentUser = "";

    // é¡µé¢åŠ è½½ï¼šè¯»å–è¿œç«¯åå•å¹¶åˆå¹¶æœ¬åœ°æ•°æ®
    window.addEventListener('load', async () => {
        // å¦‚æœæ²¡æœ‰æ›¿æ¢ SUPA_URL/SUPA_KEYï¼Œæç¤ºå¹¶åªä½¿ç”¨æœ¬åœ°æ•°æ®
        if (SUPA_URL.includes("REPLACE_WITH") || SUPA_KEY.includes("REPLACE_WITH")) {
            console.warn("è¯·å°† SUPA_URL å’Œ SUPA_KEY æ›¿æ¢ä¸ºä½ çš„ Supabase é¡¹ç›®é…ç½®ï¼Œå¦åˆ™é¡µé¢å°†åªä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚");
            renderRecordsFromLocal(); // é€€å›åˆ°æœ¬åœ°æ¸²æŸ“
            checkDailyStatus();
            return;
        }

        await loadRecords(); // ä» Supabase è¯»å–å¹¶æ¸²æŸ“
        renderRecordsFromLocalAsFallback(); // ä»æ¸²æŸ“æœ¬åœ°è®°å½•ï¼ˆåˆå¹¶ï¼‰
        checkDailyStatus();
        // å®šæ—¶åˆ·æ–°ï¼ˆæ¯ 8 ç§’ï¼‰
        setInterval(loadRecords, 8000);
    });

    // ---------- Supabase æ“ä½œ ----------
    async function saveRecordToSupabase(user, prize) {
        try {
            const { error } = await supabase
                .from('records')
                .insert({ user_name: user, prize: prize });
            if (error) {
                console.error("Supabase å†™å…¥å¤±è´¥ï¼š", error);
                return false;
            }
            return true;
        } catch (e) {
            console.error("Supabase å†™å…¥å¼‚å¸¸ï¼š", e);
            return false;
        }
    }

    async function loadRecords() {
        try {
            const { data, error } = await supabase
                .from('records')
                .select('user_name, prize, created_at')
                .order('created_at', { ascending: false })
                .limit(200);

            if (error) {
                console.error("è¯»å– Supabase å¤±è´¥ï¼š", error);
                return;
            }
            renderRecordsFromRemote(data);
        } catch (e) {
            console.error("è¯»å– Supabase å¼‚å¸¸ï¼š", e);
        }
    }

    // ---------- æ¸²æŸ“å‡½æ•° ----------
    // æ¸²æŸ“ä» Supabase æ‹‰åˆ°çš„æ•°æ®ï¼ˆä¼˜å…ˆæ˜¾ç¤ºè¿œç«¯ï¼‰
    function renderRecordsFromRemote(remoteData) {
        const listContainer = document.getElementById('marqueeList');
        listContainer.innerHTML = '';

        // å–æœ¬åœ°æ•°æ®ä½œä¸ºå‰ç¼€ï¼ˆæœ¬åœ°æœ€æ–°æ”¾å‰ï¼‰
        let localRecords = JSON.parse(localStorage.getItem(STORAGE_KEY_RECORDS) || "[]");
        localRecords = localRecords.slice().reverse(); // æœ€æ–°çš„åœ¨å‰

        // é»˜è®¤è™šæ‹Ÿæ•°æ®ï¼ˆå½“è¿œç«¯ä¸ºç©ºæ—¶æ˜¾ç¤ºç”¨ï¼‰
        const defaultRecords = [
            { user_name: "180****0182", prize: "iPhone XS", created_at: "2023-10-01" },
            { user_name: "183****1143", prize: "åœ£ç½—å…°å£çº¢", created_at: "2023-10-02" },
            { user_name: "138****8888", prize: "æ¢æ¢VIPä¼šå‘˜", created_at: "2023-10-03" }
        ];

        // åˆå¹¶ï¼šæœ¬åœ° -> è¿œç«¯ -> é»˜è®¤ï¼ˆè¿œç«¯å¯èƒ½åŒ…å«å¤§éƒ¨åˆ†çœŸå®ç”¨æˆ·ï¼‰
        const remoteFormatted = (remoteData || []).map(r => ({
            user_name: r.user_name,
            prize: r.prize,
            created_at: r.created_at
        }));

        const all = [...localRecords, ...remoteFormatted, ...defaultRecords];

        all.forEach(rec => {
            const div = document.createElement('div');
            div.className = 'record-item';
            // æ—¶é—´æ˜¾ç¤º
            const timeText = rec.created_at ? formatTime(rec.created_at) : '';
            div.innerHTML = `<b>${maskName(rec.user_name)}</b> è·å¾— ${rec.prize} <span class="record-time">${timeText}</span>`;
            listContainer.appendChild(div);
        });
    }

    // å½“ Supabase æœªé…ç½®æˆ–å‡ºé”™æ—¶ï¼Œä»…æ¸²æŸ“æœ¬åœ°è®°å½•ï¼ˆå›é€€ï¼‰
    function renderRecordsFromLocal() {
        const listContainer = document.getElementById('marqueeList');
        listContainer.innerHTML = '';

        let localRecords = JSON.parse(localStorage.getItem(STORAGE_KEY_RECORDS) || "[]");
        const defaultRecords = [
            { name: "180****0182", prize: "iPhone XS", time: "2023/10/01" },
            { name: "183****1143", prize: "åœ£ç½—å…°å£çº¢", time: "2023/10/02" },
            { name: "138****8888", prize: "æ¢æ¢VIPä¼šå‘˜", time: "2023/10/03" }
        ];

        const all = [...localRecords.slice().reverse(), ...defaultRecords];

        all.forEach(rec => {
            const div = document.createElement('div');
            div.className = 'record-item';
            const timeStr = rec.time || '';
            div.innerHTML = `<b>${maskName(rec.name || rec.user_name)}</b> è·å¾— ${rec.prize} <span class="record-time">${timeStr}</span>`;
            listContainer.appendChild(div);
        });
    }

    // å½“ Supabase å¯ç”¨ä½†å¸Œæœ›åŒæ—¶æ˜¾ç¤ºæœ¬åœ°ç¼“å­˜ï¼ˆåˆå¹¶ç­–ç•¥ï¼‰
    function renderRecordsFromLocalAsFallback() {
        // å¦‚æœ Supabase å·²æ¸²æŸ“ remoteï¼Œä¼šåœ¨ loadRecords ä¸­æ›´æ–°ï¼›è¿™é‡Œå¯ä»¥é€‰æ‹©ä¸é‡å¤è¦†ç›–ã€‚
        // ä¸ºç®€å•èµ·è§ï¼šå¦‚æœå·²åŠ è½½è¿œç«¯æ•°æ®ï¼ˆmarqueeList å­å…ƒç´  > 0 ä¸”ä¸æ˜¯ç©ºï¼‰ï¼Œæˆ‘ä»¬ä¸å†è¦†ç›–ã€‚
        const listContainer = document.getElementById('marqueeList');
        if (listContainer.children.length > 0) return;
        renderRecordsFromLocal();
    }

    // ---------- è¾…åŠ©å·¥å…· ----------
    function maskName(name) {
        if (!name) return 'åŒ¿åç”¨æˆ·';
        // å¦‚æœå·²ç»æ˜¯æ‰‹æœºå·æ©ç æ ¼å¼ï¼Œå°±ç›´æ¥è¿”å›
        if (/\d{3}\*{4}\d{4}/.test(name)) return name;
        if (name.length <= 2) return name[0] + '*';
        return name.slice(0,1) + '***' + name.slice(-1);
    }

    function formatTime(t) {
        try {
            const d = new Date(t);
            if (isNaN(d)) return t;
            return d.toLocaleString();
        } catch (e) {
            return t;
        }
    }

    // ---------- æŠ½å¥– / æœ¬åœ°é€»è¾‘ ----------
    function checkDailyStatus() {
        const lastDate = localStorage.getItem(STORAGE_KEY_LAST_DATE);
        const today = new Date().toLocaleDateString();
        const btn = document.getElementById('drawBtn');

        if (lastDate === today) {
            btn.classList.add('disabled');
            btn.innerText = "å·²æŠ½";
            return false; // ç¦æ­¢æŠ½å¥–
        } else {
            btn.classList.remove('disabled');
            btn.innerText = "æŠ½å¥–";
            return true; // å…è®¸æŠ½å¥–
        }
    }

    function checkUserAndSpin() {
        if (isSpinning) return;
        if (!checkDailyStatus()) { alert("æ‚¨ä»Šå¤©å·²ç»æŠ½è¿‡å¥–äº†ï¼Œè¯·æ˜å¤©å†æ¥ï¼"); return; }

        if (!currentUser) {
            const modal = document.getElementById('nameModal');
modal.style.display = 'flex';
modal.style.opacity = '1';   // åŠ ä¸Šè¿™å¥ä¿é™©
            setTimeout(() => document.getElementById('usernameInput').focus(), 100);
        } else {
            startLottery();
        }
    }

    function submitName() {
        const input = document.getElementById('usernameInput');
        const name = input.value.trim();
        if (!name) { alert("è¯·è¾“å…¥å§“å"); return; }
        currentUser = name;
        document.getElementById('nameModal').style.display = 'none';
        startLottery();
    }

    // æŠ½å¥–åŠ¨ç”»ä¸ç»“æœåˆ¤å®šï¼ˆä¿æŒä½ åŸæœ‰çš„é€»è¾‘ï¼‰
    function startLottery() {
        if (isSpinning) return;
        isSpinning = true;

        const wheel = document.getElementById('wheel');
        const baseSpins = 1800; // å¤§è½¬æ•°ï¼Œç¡®ä¿æœ‰è½¬åŠ¨æ„Ÿ
        const randomOffset = Math.floor(Math.random() * 360);
        currentRotation += (baseSpins + randomOffset);
        wheel.style.transform = `rotate(${currentRotation}deg)`;

        setTimeout(async () => {
            isSpinning = false;

            const actualDeg = currentRotation % 360;
            let pointingDeg = 360 - actualDeg;
            if (pointingDeg === 360) pointingDeg = 0;

            let prize = "";
            if (pointingDeg >= 0 && pointingDeg < 60) prize = "çºªæ¢µå¸Œå°ç¾Šçš®å£çº¢";
            else if (pointingDeg >= 60 && pointingDeg < 120) prize = "è°¢è°¢å‚ä¸";
            else if (pointingDeg >= 120 && pointingDeg < 180) prize = "åœ£ç½—å…°å£çº¢";
            else if (pointingDeg >= 180 && pointingDeg < 240) prize = "iPhone XS";
            else if (pointingDeg >= 240 && pointingDeg < 300) prize = "æ¢æ¢VIPä¼šå‘˜";
            else if (pointingDeg >= 300 && pointingDeg < 360) prize = "ARMANIé˜¿ç›å°¼";

            handleResult(prize);
        }, 4000);
    }

    async function handleResult(prize) {
        alert(`ğŸ‰ ç»“æœæ­æ™“ï¼š\n${prize}`);

        // æ ‡è®°ä»Šæ—¥å·²æŠ½
        const today = new Date().toLocaleDateString();
        localStorage.setItem(STORAGE_KEY_LAST_DATE, today);
        checkDailyStatus();

        // å¦‚æœä¸æ˜¯â€œè°¢è°¢å‚ä¸â€ï¼Œä¿å­˜è®°å½•ï¼ˆæœ¬åœ° + Supabaseï¼‰
        if (prize !== "è°¢è°¢å‚ä¸") {
            const newRecordLocal = {
                name: currentUser,
                prize: prize,
                time: new Date().toLocaleString()
            };

            // ä¿å­˜åˆ°æœ¬åœ°ï¼ˆä¾›ç¦»çº¿æˆ–å›é€€ç”¨ï¼‰
            let localRecords = JSON.parse(localStorage.getItem(STORAGE_KEY_RECORDS) || "[]");
            localRecords.push(newRecordLocal);
            localStorage.setItem(STORAGE_KEY_RECORDS, JSON.stringify(localRecords));

            // åŒæ­¥å†™å…¥ Supabaseï¼ˆè‹¥é…ç½®æ­£ç¡®ï¼‰
            if (!(SUPA_URL.includes("REPLACE_WITH") || SUPA_KEY.includes("REPLACE_WITH"))) {
                const ok = await saveRecordToSupabase(currentUser, prize);
                if (!ok) {
                    console.warn("å†™å…¥è¿œç«¯å¤±è´¥ï¼Œè®°å½•å·²ä¿å­˜åœ¨æœ¬åœ°ç¼“å­˜");
                } else {
                    // è‹¥å†™å…¥æˆåŠŸï¼Œä¼˜å…ˆä»è¿œç«¯é‡æ–°æ‹‰å–æœ€æ–°åå•å¹¶æ¸²æŸ“
                    await loadRecords();
                }
            } else {
                // æœªé…ç½® Supabase æ—¶ï¼Œç›´æ¥æ¸²æŸ“æœ¬åœ°è®°å½•
                renderRecordsFromLocal();
            }

            // æ»šåŠ¨åˆ°é¡¶éƒ¨ä»¥ä¾¿çœ‹åˆ°åˆšä¸­ä¹‹äºº
            const listEl = document.getElementById('marqueeList');
            listEl.scrollTop = 0;
        }
    }

    </script>
</body>
</html>
